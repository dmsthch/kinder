<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.cafe24.dmsthch.Teacher.TeacherMapper">

<insert id="insert" parameterType="com.cafe24.dmsthch.Teacher.Teacher">
INSERT INTO teacher 
	(
	teacher_no
	,license_kindergarten
	,teacher_level
	,teacher_name
	,teacher_id
	,teacher_pw
	,teacher_add_day
	,teacher_phone
	)
VALUES 
	(#{teacher_no}
	,"GUEST"
	,#{teacher_level}
	,#{teacher_name}
	,#{teacher_id}
	,#{teacher_pw}
	,#{teacher_add_day}
	,#{teacher_phone}
)
</insert>

<select id="login" parameterType="com.cafe24.dmsthch.Teacher.Teacher" resultType="com.cafe24.dmsthch.Teacher.Teacher">

SELECT 
	teacher_no,teacher_name,teacher_id,teacher_level,license_kindergarten
	FROM 
	teacher
	WHERE
	teacher_id = #{teacher_id}
	AND 
	teacher_pw = #{teacher_pw}
</select>

<!-- teacher_no는 int타입이니  parameterType="int"가 되겠고 반환값은 여러개니까 Teacher전역변수가 된다-->
<select id="OneSelectTeacher" parameterType="int" resultType="com.cafe24.dmsthch.Teacher.Teacher">

SELECT * 
FROM teacher 
WHERE 
teacher_no = #{teacher_no}

</select>





<!-- 회원 아이디 중복 체크 -->
 <select id="sign_up_id_check" parameterType="java.lang.String" resultType="int">
SELECT
count(*)
FROM
teacher
WHERE teacher_id = #{teacher_id};
<!-- 
★★★방식1

SELECT sum(C.cnt)
FROM
(
select count(*) cnt
from teacher
WHERE teacher_id = #{teacher_id}

union all

select count(*) cnt
from remove_id
WHERE teacher_id = #{teacher_id}
)C 

★★★방식2

SELECT
count(*)
FROM teacher
WHERE teacher_id = #{teacher_id}

union all
 
SELECT
count(*)
FROM remove_id
WHERE teacher_id = #{teacher_id}

-->
 </select>
 
 <!-- 회원 아이디 중복 체크2(remove_id테이블) -->
 <select id="sign_up_id_check2" parameterType="java.lang.String" resultType="int">
SELECT
count(*)
FROM
remove_id
WHERE teacher_id = #{teacher_id};
 </select>





<!-- 전체 교원 조회 table list에 필요 -->
<!-- 입력값은 라이선스 하나니까 String이고 리턴값은 여러개이니 Teacher인 오브젝트이다 -->
<select id="tableList" parameterType="java.lang.String" resultType="com.cafe24.dmsthch.Teacher.Teacher">

select 
  teacher_no
, teacher_id
, teacher_level
, teacher_name
, teacher_add_day
, teacher_phone
, teacher_bank
, teacher_account
, teacher_paystep
 from 
 	teacher
 where 
 	license_kindergarten = #{licenseKindergarten};

</select>

<!-- 입력값과 결과값을 생각하고 타입을 지정하자. -->  

<!-- 회원탈퇴 후 삭제된 아이디에 들어갈 쿼리 -->
<delete id="deleteAccount" parameterType="java.lang.String">
DELETE FROM teacher 
WHERE teacher_id = #{teacher_id};
</delete>
<!-- 입력값 하나 그것도 아이디만 넣는것이니 String이고 리턴값은 없어도 된다 -->
<insert id="insertId" parameterType="java.lang.String">
INSERT INTO remove_id(teacher_id) 
VALUES(#{teacher_id});
</insert>
<!-- 회원탈퇴 후 삭제된 아이디에 들어갈 쿼리 END-->



<!-- 편성폼에 들어갈 쿼리 -->
<!-- 입력값은 라이선스 ,level 두 개이니 Teacher이고 result값은 여러 개 이고 타입도 여러개이므로 List<Object>이다 -->
<!-- 세션의 값을 가져오는 것이니 = #{} 이 안에는 세션에 저장된 이름을 적어야 한다  -->
<select id="takeTeacher" parameterType="com.cafe24.dmsthch.Teacher.Teacher" resultType="com.cafe24.dmsthch.Teacher.Teacher">
SELECT 
teacher_no
,teacher_name
from teacher 
where 
 license_kindergarten = #{licenseKindergarten} 
AND
 teacher_level= '선생님';
</select>

<!-- 입력값은 라이선스 하나니까 String이고 값이 여러개인 int니까 List<Integer>이다 -->
<!-- 세션의 값을 가져오는 것이니 = #{} 이 안에는 세션에 저장된 이름을 적어야 한다  -->
<!-- 
	 DB안에는 class_no라고 되어 있어서 class_no라고 적었고 ChildClass 전역변수 안에는 
	 classNo라고 되어 있어서 AS classNo 로 변환시켜줘야한다 
-->
<select id="takeClass" parameterType="java.lang.String" resultType="com.cafe24.dmsthch.Child.ChildClass">
SELECT 
class_no AS classNo
, class_age AS classAge
from kid_class  
where license_kindergarten = #{licenseKindergarten};
</select>
<!-- 편성폼에 들어갈 쿼리 END -->

</mapper>